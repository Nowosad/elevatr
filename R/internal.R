#' function to convert lat long to xyz tile
latlong_to_tilexy <- function(lat_deg, lon_deg, zoom){
  #Code from http://wiki.openstreetmap.org/wiki/Slippy_map_tilenames#Coordinates_to_tile_numbers_2
  lat_rad <- lat_deg * pi /180
  n <- 2.0 ^ zoom
  xtile <- floor((lon_deg + 180.0) / 360.0 * n)
  ytile = floor((1.0 - log(tan(lat_rad) + (1 / cos(lat_rad))) / pi) / 2.0 * n)
  return(c(xtile, ytile))
}

#' function to get a data.frame of all xyz tiles to download
get_tilexy <- function(bbx,z){
  min_tile <- latlong_to_tilexy(bbx[2,1],bbx[1,1],z)
  max_tile <- latlong_to_tilexy(bbx[2,2],bbx[1,2],z)
  return(expand.grid(min_tile[1]:max_tile[1],min_tile[2]:max_tile[2]))
}

#' function to check input type and projection and convert data frame to 
#' SpatialPoints
loc_check <- function(locations,prj = NULL){
  if(class(locations)=="data.frame"){ 
    if(is.null(prj)){
      stop("Please supply a valid proj.4 string.")
    }
    locations<-SpatialPointsDataFrame(coordinates(loc_df),
                             proj4string = CRS(prj))
  } else if(grepl("SpatialPoints",class(locations)) & 
                 is.na(sp::proj4string(locations))){
    stop("Please supply a valid proj.4 string.")
  } 
  locations
}